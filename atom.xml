<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Zack&#39;s Blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://hyzhangyong.github.io/"/>
  <updated>2016-06-23T16:43:14.316Z</updated>
  <id>http://hyzhangyong.github.io/</id>
  
  <author>
    <name>Zack</name>
    <email>hyzhangyong@yeah.net</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Python实现车牌定位及分割</title>
    <link href="http://hyzhangyong.github.io/2016/06/23/Python%E5%AE%9E%E7%8E%B0%E8%BD%A6%E7%89%8C%E5%AE%9A%E4%BD%8D%E5%8F%8A%E5%88%86%E5%89%B2/"/>
    <id>http://hyzhangyong.github.io/2016/06/23/Python实现车牌定位及分割/</id>
    <published>2016-06-23T07:47:02.000Z</published>
    <updated>2016-06-23T16:43:14.316Z</updated>
    
    <content type="html">&lt;h2 id=&quot;具体步骤&quot;&gt;&lt;a href=&quot;#具体步骤&quot; class=&quot;headerlink&quot; title=&quot;具体步骤&quot;&gt;&lt;/a&gt;具体步骤&lt;/h2&gt;&lt;p&gt;1、将采集到的彩色车牌图像转换成灰度图&lt;br&gt;2、灰度化的图像利用高斯平滑处理后，再对其进行中直滤波&lt;br&gt;3、使用Sobel算子对图像进行边缘检测&lt;br&gt;4、对二值化的图像进行腐蚀，膨胀，开运算，闭运算的形态学组合变换&lt;br&gt;5、对形态学变换后的图像进行轮廓查找，根据车牌的长宽比提取车牌&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;代码实现&quot;&gt;&lt;a href=&quot;#代码实现&quot; class=&quot;headerlink&quot; title=&quot;代码实现&quot;&gt;&lt;/a&gt;代码实现&lt;/h2&gt;&lt;h3 id=&quot;图像灰度化&quot;&gt;&lt;a href=&quot;#图像灰度化&quot; class=&quot;headerlink&quot; title=&quot;图像灰度化&quot;&gt;&lt;/a&gt;图像灰度化&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/gray.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;高斯平滑，中值滤波处理&quot;&gt;&lt;a href=&quot;#高斯平滑，中值滤波处理&quot; class=&quot;headerlink&quot; title=&quot;高斯平滑，中值滤波处理&quot;&gt;&lt;/a&gt;高斯平滑，中值滤波处理&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;gaussian = cv2.GaussianBlur(gray, (&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, cv2.BORDER_DEFAULT)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;median = cv2.medianBlur(gaussian, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/gaussian.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/median.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Sobel边缘检测&quot;&gt;&lt;a href=&quot;#Sobel边缘检测&quot; class=&quot;headerlink&quot; title=&quot;Sobel边缘检测&quot;&gt;&lt;/a&gt;Sobel边缘检测&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sobel = cv2.Sobel(median, cv2.CV_8U, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,  ksize = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/sobel.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;二值化&quot;&gt;&lt;a href=&quot;#二值化&quot; class=&quot;headerlink&quot; title=&quot;二值化&quot;&gt;&lt;/a&gt;二值化&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ret, binary = cv2.threshold(sobel, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, cv2.THRESH_BINARY)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/binary.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;对二值化的图像进行腐蚀，膨胀，开运算，闭运算的形态学组合变换&quot;&gt;&lt;a href=&quot;#对二值化的图像进行腐蚀，膨胀，开运算，闭运算的形态学组合变换&quot; class=&quot;headerlink&quot; title=&quot;对二值化的图像进行腐蚀，膨胀，开运算，闭运算的形态学组合变换&quot;&gt;&lt;/a&gt;对二值化的图像进行腐蚀，膨胀，开运算，闭运算的形态学组合变换&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 膨胀和腐蚀操作的核函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;element1 = cv2.getStructuringElement(cv2.MORPH_RECT, (&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;element2 = cv2.getStructuringElement(cv2.MORPH_RECT, (&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 膨胀一次，让轮廓突出&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dilation = cv2.dilate(binary, element2, iterations = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 腐蚀一次，去掉细节&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;erosion = cv2.erode(dilation, element1, iterations = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 再次膨胀，让轮廓明显一些&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dilation2 = cv2.dilate(erosion, element2,iterations = &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/dilation2.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;对形态学变换后的图像进行轮廓查找，根据车牌的长宽比提取车牌&quot;&gt;&lt;a href=&quot;#对形态学变换后的图像进行轮廓查找，根据车牌的长宽比提取车牌&quot; class=&quot;headerlink&quot; title=&quot;对形态学变换后的图像进行轮廓查找，根据车牌的长宽比提取车牌&quot;&gt;&lt;/a&gt;对形态学变换后的图像进行轮廓查找，根据车牌的长宽比提取车牌&lt;/h3&gt;&lt;p&gt;1、查找车牌区域&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;findPlateNumberRegion&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(img)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	region = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;# 查找轮廓&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	contours,hierarchy = cv2.findContours(img, cv2.RETR_TREE, cv2.CHAIN_APPROX_SIMPLE)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;# 筛选面积小的&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(len(contours)):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		cnt = contours[i]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;# 计算该轮廓的面积&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		area = cv2.contourArea(cnt)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;# 面积小的都筛选掉&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (area &amp;lt; &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;# 轮廓近似，作用很小&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		epsilon = &lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt; * cv2.arcLength(cnt,&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		approx = cv2.approxPolyDP(cnt, epsilon, &lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;# 找到最小的矩形，该矩形可能有方向&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		rect = cv2.minAreaRect(cnt)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;rect is: &quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; rect&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;# box是四个点的坐标&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		box = cv2.cv.BoxPoints(rect)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		box = np.int0(box)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;# 计算高和宽&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		height = abs(box[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;] - box[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		width = abs(box[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] - box[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;comment&quot;&gt;# 车牌正常情况下长高比在2.7-5之间&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		ratio =float(width) / float(height)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (ratio &amp;gt; &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;or&lt;/span&gt; ratio &amp;lt; &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		region.append(box)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; region&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;2、用绿线绘出车牌区域和切割车牌&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 用绿线画出这些找到的轮廓&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; box &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; region:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	cv2.drawContours(img, [box], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, (&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;), &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ys = [box[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], box[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], box[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], box[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xs = [box[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], box[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], box[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], box[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ys_sorted_index = np.argsort(ys)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xs_sorted_index = np.argsort(xs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;x1 = box[xs_sorted_index[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;x2 = box[xs_sorted_index[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;y1 = box[ys_sorted_index[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;y2 = box[ys_sorted_index[&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;], &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;img_org2 = img.copy()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;img_plate = img_org2[y1:y2, x1:x2]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;代码地址在:&lt;a href=&quot;https://github.com/hyzhangyong/platenumber&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/hyzhangyong/platenumber&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;总结&quot;&gt;&lt;a href=&quot;#总结&quot; class=&quot;headerlink&quot; title=&quot;总结&quot;&gt;&lt;/a&gt;总结&lt;/h2&gt;&lt;p&gt;这并不完善，并不能识别所有环境下的车牌，需要进一步改善识别模式。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;具体步骤&quot;&gt;&lt;a href=&quot;#具体步骤&quot; class=&quot;headerlink&quot; title=&quot;具体步骤&quot;&gt;&lt;/a&gt;具体步骤&lt;/h2&gt;&lt;p&gt;1、将采集到的彩色车牌图像转换成灰度图&lt;br&gt;2、灰度化的图像利用高斯平滑处理后，再对其进行中直滤波&lt;br&gt;3、使用Sobel算子对图像进行边缘检测&lt;br&gt;4、对二值化的图像进行腐蚀，膨胀，开运算，闭运算的形态学组合变换&lt;br&gt;5、对形态学变换后的图像进行轮廓查找，根据车牌的长宽比提取车牌&lt;br&gt;
    
    </summary>
    
      <category term="opencv" scheme="http://hyzhangyong.github.io/categories/opencv/"/>
    
    
      <category term="opencv" scheme="http://hyzhangyong.github.io/tags/opencv/"/>
    
      <category term="python" scheme="http://hyzhangyong.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>一步一步学Scrapy:setp 3</title>
    <link href="http://hyzhangyong.github.io/2016/06/22/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6Scrapy-setp-3/"/>
    <id>http://hyzhangyong.github.io/2016/06/22/一步一步学Scrapy-setp-3/</id>
    <published>2016-06-22T02:41:57.000Z</published>
    <updated>2016-06-22T04:20:11.932Z</updated>
    
    <content type="html">&lt;p&gt;博客园博主一叶知求写的很详细啦，我这里就直接转贴（&lt;a href=&quot;http://www.cnblogs.com/rwxwsblog/p/4575894.html?utm_source=tuicool&amp;amp;utm_medium=referral&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;源地址&lt;/a&gt;）。&lt;/p&gt;
&lt;h2 id=&quot;Scrapy防止爬虫给屏蔽策略&quot;&gt;&lt;a href=&quot;#Scrapy防止爬虫给屏蔽策略&quot; class=&quot;headerlink&quot; title=&quot;Scrapy防止爬虫给屏蔽策略&quot;&gt;&lt;/a&gt;Scrapy防止爬虫给屏蔽策略&lt;/h2&gt;&lt;h4 id=&quot;要防止爬虫给屏蔽主要有以下几个策略&quot;&gt;&lt;a href=&quot;#要防止爬虫给屏蔽主要有以下几个策略&quot; class=&quot;headerlink&quot; title=&quot;要防止爬虫给屏蔽主要有以下几个策略&quot;&gt;&lt;/a&gt;要防止爬虫给屏蔽主要有以下几个策略&lt;/h4&gt;&lt;p&gt;1、动态设置user agent&lt;br&gt;2、禁用cookies&lt;br&gt;3、设置延迟下载&lt;br&gt;4、使用 Google cache&lt;br&gt;5、使用IP地址池（ Tor project 、VPN和代理IP）&lt;br&gt;6、使用 Crawlera&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;实现方式&quot;&gt;&lt;a href=&quot;#实现方式&quot; class=&quot;headerlink&quot; title=&quot;实现方式&quot;&gt;&lt;/a&gt;实现方式&lt;/h2&gt;&lt;h3 id=&quot;创建middlewares-py&quot;&gt;&lt;a href=&quot;#创建middlewares-py&quot; class=&quot;headerlink&quot; title=&quot;创建middlewares.py&quot;&gt;&lt;/a&gt;创建middlewares.py&lt;/h3&gt;&lt;p&gt;scrapy代理IP、user agent的切换都是通过DOWNLOADER_MIDDLEWARES进行控制，下面我们在博客根目录下创建middlewares.py文件（mininova/middlewares.py）。&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; random&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; base64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; settings &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; PROXIES&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;RandomUserAgent&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(object)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;&quot;&quot;Randomly rotate user agents based on a list of predefined ones&quot;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, agents)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    self.agents = agents&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;  @classmethod&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;from_crawler&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(cls, crawler)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; cls(crawler.settings.getlist(&lt;span class=&quot;string&quot;&gt;&#39;USER_AGENTS&#39;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;process_request&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, request, spider)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;#print &quot;**************************&quot; + random.choice(self.agents)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    request.headers.setdefault(&lt;span class=&quot;string&quot;&gt;&#39;User-Agent&#39;&lt;/span&gt;, random.choice(self.agents))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ProxyMiddleware&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(object)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;process_request&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, request, spider)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    proxy = random.choice(PROXIES)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; proxy[&lt;span class=&quot;string&quot;&gt;&#39;user_pass&#39;&lt;/span&gt;] &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      request.meta[&lt;span class=&quot;string&quot;&gt;&#39;proxy&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;http://%s&quot;&lt;/span&gt; % proxy[&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      encoded_user_pass = base64.encodestring(proxy[&lt;span class=&quot;string&quot;&gt;&#39;user_pass&#39;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      request.headers[&lt;span class=&quot;string&quot;&gt;&#39;Proxy-Authorization&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&#39;Basic &#39;&lt;/span&gt; + encoded_user_pass&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;**************ProxyMiddleware have pass************&quot;&lt;/span&gt; + proxy[&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;**************ProxyMiddleware no pass************&quot;&lt;/span&gt; + proxy[&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      request.meta[&lt;span class=&quot;string&quot;&gt;&#39;proxy&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&quot;http://%s&quot;&lt;/span&gt; % proxy[&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;1、类RandomUserAgent主要用来动态获取user agent，user agent列表USER_AGENTS在settings.py中进行配置。&lt;br&gt;2、类ProxyMiddleware用来切换代理，proxy列表PROXIES也是在settings.py中进行配置 。&lt;/p&gt;
&lt;h3 id=&quot;修改settings-py配置USER-AGENTS和PROXIES&quot;&gt;&lt;a href=&quot;#修改settings-py配置USER-AGENTS和PROXIES&quot; class=&quot;headerlink&quot; title=&quot;修改settings.py配置USER_AGENTS和PROXIES&quot;&gt;&lt;/a&gt;修改settings.py配置USER_AGENTS和PROXIES&lt;/h3&gt;&lt;h5 id=&quot;添加USER-AGENTS&quot;&gt;&lt;a href=&quot;#添加USER-AGENTS&quot; class=&quot;headerlink&quot; title=&quot;添加USER_AGENTS&quot;&gt;&lt;/a&gt;添加USER_AGENTS&lt;/h5&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;USER_AGENTS = [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&quot;添加代理IP设置PROXIES&quot;&gt;&lt;a href=&quot;#添加代理IP设置PROXIES&quot; class=&quot;headerlink&quot; title=&quot;添加代理IP设置PROXIES&quot;&gt;&lt;/a&gt;添加代理IP设置PROXIES&lt;/h5&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;PROXIES = [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;111.11.228.75:80&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;user_pass&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;120.198.243.22:80&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;user_pass&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;111.8.60.9:8123&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;user_pass&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;101.71.27.120:80&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;user_pass&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;122.96.59.104:80&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;user_pass&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;ip_port&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;122.224.249.122:8088&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;user_pass&#39;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;代理IP可以网上搜索一下或者购买代理池，上面的代理IP获取自：&lt;a href=&quot;http://www.xici.net.co。&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.xici.net.co。&lt;/a&gt;&lt;/p&gt;
&lt;h5 id=&quot;禁用cookies&quot;&gt;&lt;a href=&quot;#禁用cookies&quot; class=&quot;headerlink&quot; title=&quot;禁用cookies&quot;&gt;&lt;/a&gt;禁用cookies&lt;/h5&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;COOKIES_ENABLED = False&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&quot;设置下载延迟&quot;&gt;&lt;a href=&quot;#设置下载延迟&quot; class=&quot;headerlink&quot; title=&quot;设置下载延迟&quot;&gt;&lt;/a&gt;设置下载延迟&lt;/h5&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;DOWNLOAD_DELAY = 3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;测试&quot;&gt;&lt;a href=&quot;#测试&quot; class=&quot;headerlink&quot; title=&quot;测试&quot;&gt;&lt;/a&gt;测试&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;scrapy crawl mininova&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;p&gt;博客园博主一叶知求写的很详细啦，我这里就直接转贴（&lt;a href=&quot;http://www.cnblogs.com/rwxwsblog/p/4575894.html?utm_source=tuicool&amp;amp;utm_medium=referral&quot;&gt;源地址&lt;/a&gt;）。&lt;/p&gt;
&lt;h2 id=&quot;Scrapy防止爬虫给屏蔽策略&quot;&gt;&lt;a href=&quot;#Scrapy防止爬虫给屏蔽策略&quot; class=&quot;headerlink&quot; title=&quot;Scrapy防止爬虫给屏蔽策略&quot;&gt;&lt;/a&gt;Scrapy防止爬虫给屏蔽策略&lt;/h2&gt;&lt;h4 id=&quot;要防止爬虫给屏蔽主要有以下几个策略&quot;&gt;&lt;a href=&quot;#要防止爬虫给屏蔽主要有以下几个策略&quot; class=&quot;headerlink&quot; title=&quot;要防止爬虫给屏蔽主要有以下几个策略&quot;&gt;&lt;/a&gt;要防止爬虫给屏蔽主要有以下几个策略&lt;/h4&gt;&lt;p&gt;1、动态设置user agent&lt;br&gt;2、禁用cookies&lt;br&gt;3、设置延迟下载&lt;br&gt;4、使用 Google cache&lt;br&gt;5、使用IP地址池（ Tor project 、VPN和代理IP）&lt;br&gt;6、使用 Crawlera&lt;br&gt;
    
    </summary>
    
      <category term="python" scheme="http://hyzhangyong.github.io/categories/python/"/>
    
      <category term="scarpy" scheme="http://hyzhangyong.github.io/categories/python/scarpy/"/>
    
      <category term="爬虫" scheme="http://hyzhangyong.github.io/categories/python/scarpy/%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://hyzhangyong.github.io/tags/python/"/>
    
      <category term="爬虫" scheme="http://hyzhangyong.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="scrapy" scheme="http://hyzhangyong.github.io/tags/scrapy/"/>
    
  </entry>
  
  <entry>
    <title>一步一步学Scrapy:setp 2</title>
    <link href="http://hyzhangyong.github.io/2016/06/19/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6Scrapy-setp-2/"/>
    <id>http://hyzhangyong.github.io/2016/06/19/一步一步学Scrapy-setp-2/</id>
    <published>2016-06-19T05:57:17.000Z</published>
    <updated>2016-06-22T04:15:26.981Z</updated>
    
    <content type="html">&lt;p&gt;step 1简单爬取了mininova-ebook第一页的数据，接下来我们来写爬取ebook所有的数据&lt;/p&gt;
&lt;h4 id=&quot;首先我们来分析一下页面&quot;&gt;&lt;a href=&quot;#首先我们来分析一下页面&quot; class=&quot;headerlink&quot; title=&quot;首先我们来分析一下页面&quot;&gt;&lt;/a&gt;首先我们来分析一下页面&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/fenye.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;查看源代码，在点击Next »包含有下一页的链接，我们可以用来实现自动翻页爬取&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;strong&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;/sub/50/name/2&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;title&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;Next page&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Next »&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;strong&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;查看一下最后一页的源代码&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;disabled&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;Next »&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;很容易就可以发现如何判断最后一页&lt;/p&gt;
&lt;h4 id=&quot;代码实现&quot;&gt;&lt;a href=&quot;#代码实现&quot; class=&quot;headerlink&quot; title=&quot;代码实现&quot;&gt;&lt;/a&gt;代码实现&lt;/h4&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;next_page = response.xpath(&lt;span class=&quot;string&quot;&gt;u&#39;//strong/a[text()=&quot;Next »&quot;]/@href&#39;&lt;/span&gt;).extract()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;  next_page:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; next_page &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; next_page:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		next_page = &lt;span class=&quot;string&quot;&gt;&#39;http://www.mininova.org&#39;&lt;/span&gt; + next_page&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; scrapy.Request(next_page,callback=self.parse)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;由于每一页的代码格式是一样的，那么就直接&lt;code&gt;callback=self.parse&lt;/code&gt;直接调用parse函数来获取数据。&lt;/p&gt;
&lt;h4 id=&quot;简单配置Scrapy防止爬虫给封&quot;&gt;&lt;a href=&quot;#简单配置Scrapy防止爬虫给封&quot; class=&quot;headerlink&quot; title=&quot;简单配置Scrapy防止爬虫给封&quot;&gt;&lt;/a&gt;简单配置Scrapy防止爬虫给封&lt;/h4&gt;&lt;p&gt;1、详细配置留下一篇在详解，这里只设置download_delay值，它的作用主要设置下载的等待时间，大规模集中的访问对服务器的影响最大，相当于段时间增大服务器负载。&lt;br&gt;2、在mininova目录下有一个&lt;code&gt;settings.py&lt;/code&gt;文件，打开&lt;code&gt;settings.py&lt;/code&gt;找到&lt;code&gt;# DOWNLOAD_DELAY&lt;/code&gt;去掉注释号，修改值为3&lt;code&gt;DOWNLOAD_DELAY = 3&lt;/code&gt;间隔3秒。&lt;/p&gt;
&lt;h4 id=&quot;将爬取的数据，保存在数据库中&quot;&gt;&lt;a href=&quot;#将爬取的数据，保存在数据库中&quot; class=&quot;headerlink&quot; title=&quot;将爬取的数据，保存在数据库中&quot;&gt;&lt;/a&gt;将爬取的数据，保存在数据库中&lt;/h4&gt;&lt;p&gt;1、当item在Spider中被收集之后，它将会被传递到item Pipline，我们将利用Pipline将数据保存到数据库中&lt;br&gt;2、编写代码&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; sqlite3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; os &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; path&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; scrapy &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; signals&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; scrapy.xlib.pydispatch &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; dispatcher&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MininovaPipeline&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(object)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    filename = &lt;span class=&quot;string&quot;&gt;&#39;ebook.sqlite&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.conn = &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        dispatcher.connect(self.initialize, signals.engine_started)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        dispatcher.connect(self.finalize, signals.engine_stopped)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;process_item&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, item, spider)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.conn.execute(&lt;span class=&quot;string&quot;&gt;&#39;insert into ebook values(?,?,?,?)&#39;&lt;/span&gt;,  (&lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;, item[&lt;span class=&quot;string&quot;&gt;&#39;title&#39;&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;], \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        item[&lt;span class=&quot;string&quot;&gt;&#39;link&#39;&lt;/span&gt;], item[&lt;span class=&quot;string&quot;&gt;&#39;size&#39;&lt;/span&gt;]))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; item&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; path.exists(self.filename):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.conn = sqlite3.connect(self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.conn = self.create_table(self.filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;finalize&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; self.conn &lt;span class=&quot;keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.conn.commit()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.conn.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.conn = &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;create_table&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, filename)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        conn = sqlite3.connect(filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        conn.execute(&lt;span class=&quot;string&quot;&gt;&quot;&quot;&quot;create table ebook(id integer primary key autoincrement, title text, link text, size text)&quot;&quot;&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        conn.commit()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; conn&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;3、修改&lt;code&gt;settings.py&lt;/code&gt;修改&lt;code&gt;ITEM_PIPELINES&lt;/code&gt;的值，&lt;code&gt;ITEM_PIPELINES = {&amp;#39;mininova.pipelines.MininovaPipeline&amp;#39;:300}&lt;/code&gt;&lt;br&gt;4、执行&lt;code&gt;scrapy crawl mininova&lt;/code&gt;即可，执行时将在miniova目录下生成ebook.sqlite数据库文件，并将采集回来的数据保存在数据库文件中。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;step 1简单爬取了mininova-ebook第一页的数据，接下来我们来写爬取ebook所有的数据&lt;/p&gt;
&lt;h4 id=&quot;首先我们来分析一下页面&quot;&gt;&lt;a href=&quot;#首先我们来分析一下页面&quot; class=&quot;headerlink&quot; title=&quot;首先我们来分析一下页面&quot;&gt;&lt;/a&gt;首先我们来分析一下页面&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/fenye.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;查看源代码，在点击Next »包含有下一页的链接，我们可以用来实现自动翻页爬取&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;strong&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;href&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;/sub/50/name/2&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;title&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;Next page&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Next »&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;strong&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;查看一下最后一页的源代码&lt;br&gt;&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;disabled&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;Next »&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="python" scheme="http://hyzhangyong.github.io/categories/python/"/>
    
      <category term="scarpy" scheme="http://hyzhangyong.github.io/categories/python/scarpy/"/>
    
    
      <category term="python" scheme="http://hyzhangyong.github.io/tags/python/"/>
    
      <category term="爬虫" scheme="http://hyzhangyong.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="scarpy" scheme="http://hyzhangyong.github.io/tags/scarpy/"/>
    
      <category term="分页爬取" scheme="http://hyzhangyong.github.io/tags/%E5%88%86%E9%A1%B5%E7%88%AC%E5%8F%96/"/>
    
  </entry>
  
  <entry>
    <title>一步一步学Scrapy:step 1</title>
    <link href="http://hyzhangyong.github.io/2016/06/17/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6Scrapy-step-1/"/>
    <id>http://hyzhangyong.github.io/2016/06/17/一步一步学Scrapy-step-1/</id>
    <published>2016-06-17T13:21:45.000Z</published>
    <updated>2016-06-22T03:44:43.713Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Ubuntu下安装Scrapy&quot;&gt;&lt;a href=&quot;#Ubuntu下安装Scrapy&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu下安装Scrapy&quot;&gt;&lt;/a&gt;Ubuntu下安装Scrapy&lt;/h2&gt;&lt;p&gt;1、首先需要安装如下软件&lt;br&gt;&lt;code&gt;Python 2.7&lt;/code&gt;&lt;br&gt;&lt;code&gt;lxml&lt;/code&gt;&lt;br&gt;&lt;code&gt;OpenSSL&lt;/code&gt;&lt;br&gt;&lt;code&gt;pip or easy_install&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2、安装必备软件&lt;br&gt;&lt;code&gt;sudo apt-get install libevent-dev&lt;/code&gt;&lt;br&gt;&lt;code&gt;sudo apt-get install python-dev&lt;/code&gt;&lt;br&gt;&lt;code&gt;sudo apt-get install libxml2-dev&lt;/code&gt;&lt;br&gt;&lt;code&gt;sudo apt-get install libxslt1-dev&lt;/code&gt;&lt;br&gt;&lt;code&gt;sudo apt-get install python-setuptools&lt;/code&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;3、安装Scrapy&lt;br&gt;&lt;code&gt;sudo apt-get install Scrapy&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;创建项目&quot;&gt;&lt;a href=&quot;#创建项目&quot; class=&quot;headerlink&quot; title=&quot;创建项目&quot;&gt;&lt;/a&gt;创建项目&lt;/h2&gt;&lt;p&gt;以爬取mininova中的EBOOK种子链接、名称、大小为例&lt;br&gt;1、进入存储代码的目录中，运行下列命令&lt;br&gt;&lt;code&gt;scrapy startproject mininova&lt;/code&gt;&lt;br&gt;该命令将会创建包含下列内容的&lt;code&gt;mininova&lt;/code&gt;目录&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mininova/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	scrapy.cfg&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    mininova/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	__init__.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        items.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pipelines.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        settings.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        spiders/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	__init__.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这些文件分别是:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;scrapy.cfg&lt;/code&gt;:项目的配置文件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mininova/&lt;/code&gt;:该项目的python模块。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mininova/items.py&lt;/code&gt;:项目中的item文件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mininova/pipelines.py&lt;/code&gt;:项目中pipelines文件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mininova/settings.py&lt;/code&gt;:项目的设置文件&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mininova/spiders/&lt;/code&gt;:放置spider代码的目录&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2、定义Item&lt;br&gt;编辑&lt;code&gt;mininova&lt;/code&gt;目录中的&lt;code&gt;items.py&lt;/code&gt;文件:&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; scrapy&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MininovaItem&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(scrapy.Item)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    title = scrapy.Field()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    link = scrapy.Field()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    size = scrapy.Field()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;3、编写第一个爬虫(Spider)&lt;br&gt;为了创建一个Spider,必须继承&lt;code&gt;scrapy.Spider&lt;/code&gt;类，且定义一下三个属性:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;name&lt;/code&gt;:用于区别Spider。该名字必须是唯一的，不可以为不同的Spider设定相同的名字。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;start_urls&lt;/code&gt;：包含了Spider在启动时进行爬取的url列表。因此，第一个被获取到的页面将是其中之一。后续的URL则从初始的URL获取到的数据中提取。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;parse()&lt;/code&gt;:是spider的一个方法。被调用时，每个初始URL完成下载后生成的&lt;code&gt;Response&lt;/code&gt;对象将会作为唯一的参数传递给该函数。该方法负责解析返回的数据(response data),提取数据(生成item)以及生成需要进一步处理的URL的&lt;code&gt;Request&lt;/code&gt;对象。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以下为我们的第一个Spider代码，保存在&lt;code&gt;mininova/spiders&lt;/code&gt;目录下的&lt;code&gt;mininova_spider.py&lt;/code&gt;文件中:&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; scrapy&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; mininova.items &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; MininovaItem&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MininovaSpider&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(scrapy.Spider)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	name = &lt;span class=&quot;string&quot;&gt;&#39;mininova&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	allowed_domains = [&lt;span class=&quot;string&quot;&gt;&#39;mininova.org&#39;&lt;/span&gt;] &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	start_urls = [&lt;span class=&quot;string&quot;&gt;&#39;http://www.mininova.org/sub/50/name/1&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self,response)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		sites = response.xpath(&lt;span class=&quot;string&quot;&gt;&#39;//table[@class=&quot;maintable&quot;]//tr&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; site &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; sites:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			item = MininovaItem()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			item[&lt;span class=&quot;string&quot;&gt;&#39;title&#39;&lt;/span&gt;] = site.xpath(&lt;span class=&quot;string&quot;&gt;&#39;td/a[not(@class=&quot;ti com&quot;)]/text()&#39;&lt;/span&gt;).extract()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; url &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; site.xpath(&lt;span class=&quot;string&quot;&gt;&#39;td/a[@class=&quot;dl&quot;]/@href&#39;&lt;/span&gt;).extract():&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				item[&lt;span class=&quot;string&quot;&gt;&#39;link&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&#39;http://www.mininova.org&#39;&lt;/span&gt; + url&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; size &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; site.xpath(&lt;span class=&quot;string&quot;&gt;&#39;td[3]/text()&#39;&lt;/span&gt;).extract():&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				size = size.encode(&lt;span class=&quot;string&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;				item[&lt;span class=&quot;string&quot;&gt;&#39;size&#39;&lt;/span&gt;] = size.replace(&lt;span class=&quot;string&quot;&gt;&#39;\xc2\xa0&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			&lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; item&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;4、爬取&lt;br&gt;进入项目的根目录，执行下列命令启动spider:&lt;br&gt;&lt;code&gt;scrapy crawl mininova&lt;/code&gt;&lt;br&gt;5、保存爬取到的数据&lt;br&gt;&lt;code&gt;scrapy crawl mininova -o items.json&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;下一步&quot;&gt;&lt;a href=&quot;#下一步&quot; class=&quot;headerlink&quot; title=&quot;下一步&quot;&gt;&lt;/a&gt;下一步&lt;/h2&gt;&lt;p&gt;下一篇将介绍分页爬取、存入数据库及一些设置。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Ubuntu下安装Scrapy&quot;&gt;&lt;a href=&quot;#Ubuntu下安装Scrapy&quot; class=&quot;headerlink&quot; title=&quot;Ubuntu下安装Scrapy&quot;&gt;&lt;/a&gt;Ubuntu下安装Scrapy&lt;/h2&gt;&lt;p&gt;1、首先需要安装如下软件&lt;br&gt;&lt;code&gt;Python 2.7&lt;/code&gt;&lt;br&gt;&lt;code&gt;lxml&lt;/code&gt;&lt;br&gt;&lt;code&gt;OpenSSL&lt;/code&gt;&lt;br&gt;&lt;code&gt;pip or easy_install&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2、安装必备软件&lt;br&gt;&lt;code&gt;sudo apt-get install libevent-dev&lt;/code&gt;&lt;br&gt;&lt;code&gt;sudo apt-get install python-dev&lt;/code&gt;&lt;br&gt;&lt;code&gt;sudo apt-get install libxml2-dev&lt;/code&gt;&lt;br&gt;&lt;code&gt;sudo apt-get install libxslt1-dev&lt;/code&gt;&lt;br&gt;&lt;code&gt;sudo apt-get install python-setuptools&lt;/code&gt;&lt;br&gt;
    
    </summary>
    
      <category term="python" scheme="http://hyzhangyong.github.io/categories/python/"/>
    
      <category term="scrapy" scheme="http://hyzhangyong.github.io/categories/python/scrapy/"/>
    
    
      <category term="python" scheme="http://hyzhangyong.github.io/tags/python/"/>
    
      <category term="爬虫" scheme="http://hyzhangyong.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="scrapy" scheme="http://hyzhangyong.github.io/tags/scrapy/"/>
    
  </entry>
  
  <entry>
    <title>Python一些技巧</title>
    <link href="http://hyzhangyong.github.io/2016/06/16/Python%E4%B8%80%E4%BA%9B%E6%8A%80%E5%B7%A7/"/>
    <id>http://hyzhangyong.github.io/2016/06/16/Python一些技巧/</id>
    <published>2016-06-16T15:20:35.000Z</published>
    <updated>2016-06-17T08:05:37.364Z</updated>
    
    <content type="html">&lt;h4 id=&quot;记录python一些技巧&quot;&gt;&lt;a href=&quot;#记录python一些技巧&quot; class=&quot;headerlink&quot; title=&quot;记录python一些技巧&quot;&gt;&lt;/a&gt;记录python一些技巧&lt;/h4&gt;&lt;h6 id=&quot;1、使用if-a-is-not-b-而非if-not-a-is-b。&quot;&gt;&lt;a href=&quot;#1、使用if-a-is-not-b-而非if-not-a-is-b。&quot; class=&quot;headerlink&quot; title=&quot;1、使用if a is not b,而非if not a is b。&quot;&gt;&lt;/a&gt;1、使用&lt;code&gt;if a is not b&lt;/code&gt;,而非&lt;code&gt;if not a is b&lt;/code&gt;。&lt;/h6&gt;&lt;h6 id=&quot;2、不用if-len-somelist-0来检查空值，而用if-not-somelist来检查（它会假定-空值将自动评估为False）。&quot;&gt;&lt;a href=&quot;#2、不用if-len-somelist-0来检查空值，而用if-not-somelist来检查（它会假定-空值将自动评估为False）。&quot; class=&quot;headerlink&quot; title=&quot;2、不用if len(somelist) == 0来检查空值，而用if not somelist来检查（它会假定:空值将自动评估为False）。&quot;&gt;&lt;/a&gt;2、不用&lt;code&gt;if len(somelist) == 0&lt;/code&gt;来检查空值，而用&lt;code&gt;if not somelist&lt;/code&gt;来检查（它会假定:空值将自动评估为False）。&lt;/h6&gt;&lt;h6 id=&quot;3、检测是否为非空值时，用if-somelist会默认把非空值判断为True&quot;&gt;&lt;a href=&quot;#3、检测是否为非空值时，用if-somelist会默认把非空值判断为True&quot; class=&quot;headerlink&quot; title=&quot;3、检测是否为非空值时，用if somelist会默认把非空值判断为True&quot;&gt;&lt;/a&gt;3、检测是否为非空值时，用&lt;code&gt;if somelist&lt;/code&gt;会默认把非空值判断为True&lt;/h6&gt;&lt;h6 id=&quot;4、引入模块的时候，总是应该使用绝对名称，而不应该根据当前模块的路径来使用相对名称。例如，引入bar包中的foo模块时，应该完整写出from-bar-import-foo。如果一定要用相对名称来编写import语句，那就采用明确的写法-from-import-foo。import语句按顺序分三部分，分别代表标准库模块、第三方模块及自用模块，在每一部分中，各import语句应该按模块的字母顺序来排序。&quot;&gt;&lt;a href=&quot;#4、引入模块的时候，总是应该使用绝对名称，而不应该根据当前模块的路径来使用相对名称。例如，引入bar包中的foo模块时，应该完整写出from-bar-import-foo。如果一定要用相对名称来编写import语句，那就采用明确的写法-from-import-foo。import语句按顺序分三部分，分别代表标准库模块、第三方模块及自用模块，在每一部分中，各import语句应该按模块的字母顺序来排序。&quot; class=&quot;headerlink&quot; title=&quot;4、引入模块的时候，总是应该使用绝对名称，而不应该根据当前模块的路径来使用相对名称。例如，引入bar包中的foo模块时，应该完整写出from bar import foo。如果一定要用相对名称来编写import语句，那就采用明确的写法:from.import foo。import语句按顺序分三部分，分别代表标准库模块、第三方模块及自用模块，在每一部分中，各import语句应该按模块的字母顺序来排序。&quot;&gt;&lt;/a&gt;4、引入模块的时候，总是应该使用绝对名称，而不应该根据当前模块的路径来使用相对名称。例如，引入bar包中的foo模块时，应该完整写出&lt;code&gt;from bar import foo&lt;/code&gt;。如果一定要用相对名称来编写import语句，那就采用明确的写法:&lt;code&gt;from.import foo&lt;/code&gt;。import语句按顺序分三部分，分别代表标准库模块、第三方模块及自用模块，在每一部分中，各import语句应该按模块的字母顺序来排序。&lt;/h6&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h6 id=&quot;5、实现接受str或unicode-并总返回unicode&quot;&gt;&lt;a href=&quot;#5、实现接受str或unicode-并总返回unicode&quot; class=&quot;headerlink&quot; title=&quot;5、实现接受str或unicode,并总返回unicode:&quot;&gt;&lt;/a&gt;5、实现接受str或unicode,并总返回unicode:&lt;/h6&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;to_unicode&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(unicode_or_str)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; isinstance(unicode_or_str,str):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	value = unicode_or_str.decode(&lt;span class=&quot;string&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	value = unicode_or_str&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; value&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&quot;6、实现接受str或unicode-并总返回str&quot;&gt;&lt;a href=&quot;#6、实现接受str或unicode-并总返回str&quot; class=&quot;headerlink&quot; title=&quot;6、实现接受str或unicode,并总返回str&quot;&gt;&lt;/a&gt;6、实现接受str或unicode,并总返回str&lt;/h6&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;to_str&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(unicode_or_str)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; isinstance(unicode_or_str,unicode):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	value = unicode_or_str.encode(&lt;span class=&quot;string&quot;&gt;&#39;utf-8&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	value = unicode_or_str&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&quot;7、用列表推导来取代map和fileter&quot;&gt;&lt;a href=&quot;#7、用列表推导来取代map和fileter&quot; class=&quot;headerlink&quot; title=&quot;7、用列表推导来取代map和fileter&quot;&gt;&lt;/a&gt;7、用列表推导来取代map和fileter&lt;/h6&gt;&lt;h6 id=&quot;8、合并pdf&quot;&gt;&lt;a href=&quot;#8、合并pdf&quot; class=&quot;headerlink&quot; title=&quot;8、合并pdf&quot;&gt;&lt;/a&gt;8、合并pdf&lt;/h6&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; os&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; PyPDF2 &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; PdfFileReader,PdfFileMerger&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;files_dir = &lt;span class=&quot;string&quot;&gt;&#39;e:\\pdf&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pdf_files = [f &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; f &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; os.listdir(files_dir) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; f.endswith(&lt;span class=&quot;string&quot;&gt;&#39;pdf&#39;&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;merger = PdfFileMerger()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; filename &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; pdf_files:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	merger.appedn(PdfFileReader(os.path.join(file_dir,filename),&lt;span class=&quot;string&quot;&gt;&#39;rb&#39;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;merger.writer(os.path.join(files_dir,&lt;span class=&quot;string&quot;&gt;&#39;merged_full.pdf&#39;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&quot;9、文件排序（os-listdir不按照特定顺序排序）&quot;&gt;&lt;a href=&quot;#9、文件排序（os-listdir不按照特定顺序排序）&quot; class=&quot;headerlink&quot; title=&quot;9、文件排序（os.listdir不按照特定顺序排序）&quot;&gt;&lt;/a&gt;9、文件排序（os.listdir不按照特定顺序排序）&lt;/h6&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;files = os.listdir(&lt;span class=&quot;string&quot;&gt;&#39;.&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# [:-4]=.后缀&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;files.sort(key = &lt;span class=&quot;keyword&quot;&gt;lambda&lt;/span&gt; x:int(x[:&lt;span class=&quot;number&quot;&gt;-4&lt;/span&gt;]))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&quot;10、shutil-rmtree删除中文目录提示错误处理方式&quot;&gt;&lt;a href=&quot;#10、shutil-rmtree删除中文目录提示错误处理方式&quot; class=&quot;headerlink&quot; title=&quot;10、shutil.rmtree删除中文目录提示错误处理方式&quot;&gt;&lt;/a&gt;10、shutil.rmtree删除中文目录提示错误处理方式&lt;/h6&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; shutil&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;shutil.rmtree(&lt;span class=&quot;string&quot;&gt;ur&#39;E:\XX\中文目录)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# 在路径前面加u代表对字符串进行unicode编码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h6 id=&quot;11、自动补0&quot;&gt;&lt;a href=&quot;#11、自动补0&quot; class=&quot;headerlink&quot; title=&quot;11、自动补0&quot;&gt;&lt;/a&gt;11、自动补0&lt;/h6&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;n = &lt;span class=&quot;string&quot;&gt;&#39;123&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s = n.zfill(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;00123&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;n = &lt;span class=&quot;string&quot;&gt;&#39;-123&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s = n.zfill(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;-0123&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 对于纯数字，可以通过格式化的方式来补0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;n = &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;s = &lt;span class=&quot;string&quot;&gt;&#39;%05d&#39;&lt;/span&gt; % n&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;string&quot;&gt;&#39;00123&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;记录python一些技巧&quot;&gt;&lt;a href=&quot;#记录python一些技巧&quot; class=&quot;headerlink&quot; title=&quot;记录python一些技巧&quot;&gt;&lt;/a&gt;记录python一些技巧&lt;/h4&gt;&lt;h6 id=&quot;1、使用if-a-is-not-b-而非if-not-a-is-b。&quot;&gt;&lt;a href=&quot;#1、使用if-a-is-not-b-而非if-not-a-is-b。&quot; class=&quot;headerlink&quot; title=&quot;1、使用if a is not b,而非if not a is b。&quot;&gt;&lt;/a&gt;1、使用&lt;code&gt;if a is not b&lt;/code&gt;,而非&lt;code&gt;if not a is b&lt;/code&gt;。&lt;/h6&gt;&lt;h6 id=&quot;2、不用if-len-somelist-0来检查空值，而用if-not-somelist来检查（它会假定-空值将自动评估为False）。&quot;&gt;&lt;a href=&quot;#2、不用if-len-somelist-0来检查空值，而用if-not-somelist来检查（它会假定-空值将自动评估为False）。&quot; class=&quot;headerlink&quot; title=&quot;2、不用if len(somelist) == 0来检查空值，而用if not somelist来检查（它会假定:空值将自动评估为False）。&quot;&gt;&lt;/a&gt;2、不用&lt;code&gt;if len(somelist) == 0&lt;/code&gt;来检查空值，而用&lt;code&gt;if not somelist&lt;/code&gt;来检查（它会假定:空值将自动评估为False）。&lt;/h6&gt;&lt;h6 id=&quot;3、检测是否为非空值时，用if-somelist会默认把非空值判断为True&quot;&gt;&lt;a href=&quot;#3、检测是否为非空值时，用if-somelist会默认把非空值判断为True&quot; class=&quot;headerlink&quot; title=&quot;3、检测是否为非空值时，用if somelist会默认把非空值判断为True&quot;&gt;&lt;/a&gt;3、检测是否为非空值时，用&lt;code&gt;if somelist&lt;/code&gt;会默认把非空值判断为True&lt;/h6&gt;&lt;h6 id=&quot;4、引入模块的时候，总是应该使用绝对名称，而不应该根据当前模块的路径来使用相对名称。例如，引入bar包中的foo模块时，应该完整写出from-bar-import-foo。如果一定要用相对名称来编写import语句，那就采用明确的写法-from-import-foo。import语句按顺序分三部分，分别代表标准库模块、第三方模块及自用模块，在每一部分中，各import语句应该按模块的字母顺序来排序。&quot;&gt;&lt;a href=&quot;#4、引入模块的时候，总是应该使用绝对名称，而不应该根据当前模块的路径来使用相对名称。例如，引入bar包中的foo模块时，应该完整写出from-bar-import-foo。如果一定要用相对名称来编写import语句，那就采用明确的写法-from-import-foo。import语句按顺序分三部分，分别代表标准库模块、第三方模块及自用模块，在每一部分中，各import语句应该按模块的字母顺序来排序。&quot; class=&quot;headerlink&quot; title=&quot;4、引入模块的时候，总是应该使用绝对名称，而不应该根据当前模块的路径来使用相对名称。例如，引入bar包中的foo模块时，应该完整写出from bar import foo。如果一定要用相对名称来编写import语句，那就采用明确的写法:from.import foo。import语句按顺序分三部分，分别代表标准库模块、第三方模块及自用模块，在每一部分中，各import语句应该按模块的字母顺序来排序。&quot;&gt;&lt;/a&gt;4、引入模块的时候，总是应该使用绝对名称，而不应该根据当前模块的路径来使用相对名称。例如，引入bar包中的foo模块时，应该完整写出&lt;code&gt;from bar import foo&lt;/code&gt;。如果一定要用相对名称来编写import语句，那就采用明确的写法:&lt;code&gt;from.import foo&lt;/code&gt;。import语句按顺序分三部分，分别代表标准库模块、第三方模块及自用模块，在每一部分中，各import语句应该按模块的字母顺序来排序。&lt;/h6&gt;
    
    </summary>
    
      <category term="python" scheme="http://hyzhangyong.github.io/categories/python/"/>
    
    
      <category term="python" scheme="http://hyzhangyong.github.io/tags/python/"/>
    
      <category term="技巧" scheme="http://hyzhangyong.github.io/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>vertical projection for python-opencv</title>
    <link href="http://hyzhangyong.github.io/2016/05/25/vertical-projection-for-python-opencv/"/>
    <id>http://hyzhangyong.github.io/2016/05/25/vertical-projection-for-python-opencv/</id>
    <published>2016-05-25T13:59:01.000Z</published>
    <updated>2016-06-23T07:48:08.970Z</updated>
    
    <content type="html">&lt;h2 id=&quot;关于垂直投影法的python-opncv的实现方式&quot;&gt;&lt;a href=&quot;#关于垂直投影法的python-opncv的实现方式&quot; class=&quot;headerlink&quot; title=&quot;关于垂直投影法的python,opncv的实现方式&quot;&gt;&lt;/a&gt;关于垂直投影法的python,opncv的实现方式&lt;/h2&gt;&lt;h4 id=&quot;关于垂直投影的具体介绍，就不多说，直接上代码&quot;&gt;&lt;a href=&quot;#关于垂直投影的具体介绍，就不多说，直接上代码&quot; class=&quot;headerlink&quot; title=&quot;关于垂直投影的具体介绍，就不多说，直接上代码&quot;&gt;&lt;/a&gt;关于垂直投影的具体介绍，就不多说，直接上代码&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/number.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; cv2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; numpy &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 灰度化读取图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;image = cv2.imreade(&lt;span class=&quot;string&quot;&gt;&#39;number.jpg&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 将图片二值化&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;retval, img = cv2.threshold(image,&lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;,cv2.THRESH_BINAPY_INV)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 创建一个空白图片(img.shape[0]为height,img.shape[1]为width)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;paintx = np.zeros(img.shape,np.uint8)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 将新图像数组中的所有通道元素的值都设置为0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cv2.cv.Zero(cv2.cv.fromarray(paintx))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 创建width长度都为0的数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;w = [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]*image.shape[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 对每一行计算投影值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(image.shape[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; y &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(image.shape[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	t = cv2.cv.Get2D(cv2.cv.fromarray(img),y,x)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; t[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	w[x] += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 绘制垂直投影图&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(image.shape[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; y &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(w[x]):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;comment&quot;&gt;# 把为0的像素变成白&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        cv2.cv.Set2D(cv2.cv.fromarray(paintx),y,x(&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 显示图片&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cv2.imshow(&lt;span class=&quot;string&quot;&gt;&#39;paintx&#39;&lt;/span&gt;,paintx)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cv2.waitKey(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/paintx.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;另外把水平投影也一起写了&quot;&gt;&lt;a href=&quot;#另外把水平投影也一起写了&quot; class=&quot;headerlink&quot; title=&quot;另外把水平投影也一起写了&quot;&gt;&lt;/a&gt;另外把水平投影也一起写了&lt;/h4&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;painty = np.zeros(img.shape,np.uint8)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cv2.cv.Zero(cv2.cv.fromarray(painty))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;h = [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]*image.shape[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; y &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(image.shape[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;]):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(image.shape[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	s = cv2.cv.Get2D(cv2.cv.fromarray(img),y,x)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; s[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;] == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	h[y] += &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; y &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(image.shape(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(h[y]):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	cv2.cv.Set2D(cv2.cv.fromarray(painty),y,x,(&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cv2.imshow(&lt;span class=&quot;string&quot;&gt;&#39;painty&#39;&lt;/span&gt;,painty)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cv2.waitKey(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/painty.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;关于垂直投影法的python-opncv的实现方式&quot;&gt;&lt;a href=&quot;#关于垂直投影法的python-opncv的实现方式&quot; class=&quot;headerlink&quot; title=&quot;关于垂直投影法的python,opncv的实现方式&quot;&gt;&lt;/a&gt;关于垂直投影法的pyt
    
    </summary>
    
      <category term="oepncv" scheme="http://hyzhangyong.github.io/categories/oepncv/"/>
    
    
      <category term="opencv" scheme="http://hyzhangyong.github.io/tags/opencv/"/>
    
      <category term="python" scheme="http://hyzhangyong.github.io/tags/python/"/>
    
      <category term="vertical" scheme="http://hyzhangyong.github.io/tags/vertical/"/>
    
      <category term="projection" scheme="http://hyzhangyong.github.io/tags/projection/"/>
    
  </entry>
  
  <entry>
    <title>amf for python</title>
    <link href="http://hyzhangyong.github.io/2016/04/28/amf-for-python/"/>
    <id>http://hyzhangyong.github.io/2016/04/28/amf-for-python/</id>
    <published>2016-04-28T15:06:10.000Z</published>
    <updated>2016-06-17T08:06:00.916Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Python爬取FLASH播放器中的资料。&quot;&gt;&lt;a href=&quot;#Python爬取FLASH播放器中的资料。&quot; class=&quot;headerlink&quot; title=&quot;Python爬取FLASH播放器中的资料。&quot;&gt;&lt;/a&gt;Python爬取FLASH播放器中的资料。&lt;/h2&gt;&lt;h4 id=&quot;一、首先了解一下AMF协议&quot;&gt;&lt;a href=&quot;#一、首先了解一下AMF协议&quot; class=&quot;headerlink&quot; title=&quot;一、首先了解一下AMF协议:&quot;&gt;&lt;/a&gt;一、首先了解一下AMF协议:&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;AMF(Action Message Format)是Flash与服务端通信的一种常见的二进制编码模式，其传输效率高，可以在HTTP层面上传输。现在很多Flash WebGame都采用这样的消息格式。&lt;br&gt;AMF协议是基于Http协议的.&lt;br&gt;它的内容处理过程大致是这样:&lt;br&gt;1.从客户端获取Http请求(Request)流.&lt;br&gt;2.对流进行解串行化(Deserialize)，得到服务器端程序能够识别的数据，并建立一个响应(Response)消息&lt;br&gt;3.Debug开始&lt;br&gt;4.对流进行各种处理(记录、许可、服务)得到返回值&lt;br&gt;5.对响应流进行串行化&lt;br&gt;6.发送Http响应给客户端&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h4 id=&quot;二、Python与amf进行互通需要用到PyAMF&quot;&gt;&lt;a href=&quot;#二、Python与amf进行互通需要用到PyAMF&quot; class=&quot;headerlink&quot; title=&quot;二、Python与amf进行互通需要用到PyAMF&quot;&gt;&lt;/a&gt;二、Python与amf进行互通需要用到PyAMF&lt;/h4&gt;&lt;p&gt;1、下载pyamf&lt;br&gt;&lt;code&gt;https://pypi.python.org/pypi/PyAMF&lt;/code&gt;&lt;br&gt;2、安装pyamf&lt;br&gt;下载完成之后解压出来，打开DOS命令进入pyamf目录，&lt;br&gt;执行下列命令，安装pyamf框架&lt;br&gt;&lt;code&gt;python setup.py install --disable-ext&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;三、获取关键字节伪造访问&quot;&gt;&lt;a href=&quot;#三、获取关键字节伪造访问&quot; class=&quot;headerlink&quot; title=&quot;三、获取关键字节伪造访问&quot;&gt;&lt;/a&gt;三、获取关键字节伪造访问&lt;/h4&gt;&lt;p&gt;首先使用charles抓包工具，抓取AMF包，得到请求/应答的AMF数据，对AMF格式的请求和响应的数据进行分析。&lt;br&gt;解密的POST DATA如下图所示:&lt;br&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/request.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;构建flex.messaging.messages.RemotingMessage信息&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;msg= messaging.RemotiongMessage(messageId=str(uuid.uuid1()).upper(),\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	clometOd=&lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    operation=&lt;span class=&quot;string&quot;&gt;&#39;playeSource&#39;&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    destination=&lt;span class=&quot;string&quot;&gt;&#39;metaDataService&#39;&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    timeTolive=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    timestamp=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;msg.body=[&lt;span class=&quot;string&quot;&gt;&#39;xxx&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;aaaaa&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;ccccc&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;ddddd&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;eeeee&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;msg.headers[&lt;span class=&quot;string&quot;&gt;&#39;DSEndpoint&#39;&lt;/span&gt;]=&lt;span class=&quot;string&quot;&gt;&#39;my-amf&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;msg.headers[&lt;span class=&quot;string&quot;&gt;&#39;DSId&#39;&lt;/span&gt;]=str(uuid.uuid1()).upper()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;......&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;得到的Response如下图:&lt;br&gt;&lt;img src=&quot;http://7xroxn.com1.z0.glb.clouddn.com/response.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;四、具体实现代码如下&quot;&gt;&lt;a href=&quot;#四、具体实现代码如下&quot; class=&quot;headerlink&quot; title=&quot;四、具体实现代码如下:&quot;&gt;&lt;/a&gt;四、具体实现代码如下:&lt;/h4&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; urllib2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; uuid&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; pyamf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; pyamf &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; remoting&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; pyamf.flex &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; messaging&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 构造flex.messaging.messages.RemotingMessage消息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;msg= messaging.RemotiongMessage(messageId=str(uuid.uuid1()).upper(),\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	clometOd=&lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    operation=&lt;span class=&quot;string&quot;&gt;&#39;playeSource&#39;&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    destination=&lt;span class=&quot;string&quot;&gt;&#39;metaDataService&#39;&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    timeTolive=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    timestamp=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;msg.body = [&lt;span class=&quot;string&quot;&gt;&#39;xxx&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;aaaaa&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;ccccc&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;ddddd&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;eeeee&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;msg.headers[&lt;span class=&quot;string&quot;&gt;&#39;DSEndpoint&#39;&lt;/span&gt;] = &lt;span class=&quot;string&quot;&gt;&#39;my-amf&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;msg.headers[&lt;span class=&quot;string&quot;&gt;&#39;DSId&#39;&lt;/span&gt;] = str(uuid.uuid1()).upper()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 按AMF协议编码&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;req = remoting.Request(&lt;span class=&quot;string&quot;&gt;&#39;null&#39;&lt;/span&gt;, body=(msg,))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env = remoting.Envelope(amfVersion=pyamf.AMF3)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;env.bodies = [(&lt;span class=&quot;string&quot;&gt;&#39;/1&#39;&lt;/span&gt;,req)]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;data = bytes(remoting.encode(env).read())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 提交请求&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;url = &lt;span class=&quot;string&quot;&gt;&#39;http://xxxx.xx.xx/amf&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;req = urllib2.Request(url,data,headers=&amp;#123;&lt;span class=&quot;string&quot;&gt;&#39;Content-Type&#39;&lt;/span&gt;:&lt;span class=&quot;string&quot;&gt;&#39;application/x-amf&#39;&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 解析返回数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;oepner = urllib2.build_opener()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 解码AMF协议返回的数据&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;resp = remoting.decode(opener.open(req).read())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; resp.bodies[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;].body.body[&lt;span class=&quot;string&quot;&gt;&#39;xxxx&#39;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;......&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Python爬取FLASH播放器中的资料。&quot;&gt;&lt;a href=&quot;#Python爬取FLASH播放器中的资料。&quot; class=&quot;headerlink&quot; title=&quot;Python爬取FLASH播放器中的资料。&quot;&gt;&lt;/a&gt;Python爬取FLASH播放器中的资料。&lt;/h2&gt;&lt;h4 id=&quot;一、首先了解一下AMF协议&quot;&gt;&lt;a href=&quot;#一、首先了解一下AMF协议&quot; class=&quot;headerlink&quot; title=&quot;一、首先了解一下AMF协议:&quot;&gt;&lt;/a&gt;一、首先了解一下AMF协议:&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;AMF(Action Message Format)是Flash与服务端通信的一种常见的二进制编码模式，其传输效率高，可以在HTTP层面上传输。现在很多Flash WebGame都采用这样的消息格式。&lt;br&gt;AMF协议是基于Http协议的.&lt;br&gt;它的内容处理过程大致是这样:&lt;br&gt;1.从客户端获取Http请求(Request)流.&lt;br&gt;2.对流进行解串行化(Deserialize)，得到服务器端程序能够识别的数据，并建立一个响应(Response)消息&lt;br&gt;3.Debug开始&lt;br&gt;4.对流进行各种处理(记录、许可、服务)得到返回值&lt;br&gt;5.对响应流进行串行化&lt;br&gt;6.发送Http响应给客户端&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="python" scheme="http://hyzhangyong.github.io/categories/python/"/>
    
    
      <category term="python" scheme="http://hyzhangyong.github.io/tags/python/"/>
    
      <category term="amf" scheme="http://hyzhangyong.github.io/tags/amf/"/>
    
      <category term="爬虫" scheme="http://hyzhangyong.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>python线程池控制</title>
    <link href="http://hyzhangyong.github.io/2016/03/17/python%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%8E%A7%E5%88%B6/"/>
    <id>http://hyzhangyong.github.io/2016/03/17/python线程池控制/</id>
    <published>2016-03-17T02:54:15.000Z</published>
    <updated>2016-06-17T08:05:49.236Z</updated>
    
    <content type="html">&lt;p&gt;最近一个项目上使用线程池，设定处理项1W，10线程，但是需要检测线程进行状态。出现错误N次，就自动终止线程。实现如下:&lt;/p&gt;
&lt;h4 id=&quot;线程池代码&quot;&gt;&lt;a href=&quot;#线程池代码&quot; class=&quot;headerlink&quot; title=&quot;线程池代码&quot;&gt;&lt;/a&gt;线程池代码&lt;/h4&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ERRORCOUNT=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;IS_EXIT=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Worker&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Thread)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    worker_count=&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    timeout=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, workQueue,resultQueue,**kwds)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Thread.__init__(self,**kwds)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.id=Worker.worker_count&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Worker.worker_count+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.setDaemon(&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.workQueue=workQueue&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.resultQueue=resultQueue&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.start()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;#the get-some-work,do-some-work main loop of worker threads&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; IS_EXIT:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                callable,args,kwds=self.workQueue.get(timeout=Worker.timeout)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                res=callable(*args,**kwds)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                self.resultQueue.put(res)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt; Queue.Empty:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;WorkerManager&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self, num_of_workers=&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,timeout=&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.workQueue=Queue.Queue()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.resultQueue=Queue.Queue()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.workers=[]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.timeout=timeout&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self._recruitThreads(num_of_workers)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;_recruitThreads&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self,num_of_workers)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(num_of_workers):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            worker=Worker(self.workQueue,self.resultQueue)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.workers.append(worker)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;wait_for_complete&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;#then,wait for each of them to terminate&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; len(self.workers):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            worker=self.workers.pop()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            worker.join(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; worker.isAlive() &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; self.workQueue.empty():&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                self.workers.append(worker)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;add_job&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self,callable,*args,**kwds)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.workQueue.put((callable,args,kwds))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;get_result&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(self,*args,**kwds)&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; self.resultQueue.get(*args,**kwds)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在WorkerManager中使用到一个全局变量&lt;strong&gt;IS_EXIT&lt;/strong&gt;用来判断是否需要退出线程&lt;/p&gt;
&lt;h4 id=&quot;调用线程代码&quot;&gt;&lt;a href=&quot;#调用线程代码&quot; class=&quot;headerlink&quot; title=&quot;调用线程代码&quot;&gt;&lt;/a&gt;调用线程代码&lt;/h4&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;wm=WorkerManager(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;span class=&quot;comment&quot;&gt;#10线程&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; range(&lt;span class=&quot;number&quot;&gt;10000&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	wm.add_job(do_job)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;wm.wait_for_complete()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;具体工作代码&quot;&gt;&lt;a href=&quot;#具体工作代码&quot; class=&quot;headerlink&quot; title=&quot;具体工作代码&quot;&gt;&lt;/a&gt;具体工作代码&lt;/h4&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;do_job&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;global&lt;/span&gt; ERRORCOUNT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;global&lt;/span&gt; IS_EXIT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	do anything&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	ERRORCOUNT+=&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ERRORCOUNT&amp;gt;&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                IS_EXIT=&lt;span class=&quot;keyword&quot;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;此处使用了全局变量&lt;strong&gt;ERRORCOUNT&lt;/strong&gt;统计错误数量，超过指定次数，则设置&lt;strong&gt;IS_EXIT=False&lt;/strong&gt;通知线程停止执行。&lt;br&gt;至此基本上满足项目所需，但并不友好，应有更好的方式。&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;最近一个项目上使用线程池，设定处理项1W，10线程，但是需要检测线程进行状态。出现错误N次，就自动终止线程。实现如下:&lt;/p&gt;
&lt;h4 id=&quot;线程池代码&quot;&gt;&lt;a href=&quot;#线程池代码&quot; class=&quot;headerlink&quot; title=&quot;线程池代码&quot;&gt;&lt;/a&gt;线程池代码&lt;/h4&gt;
    
    </summary>
    
      <category term="python" scheme="http://hyzhangyong.github.io/categories/python/"/>
    
    
      <category term="python" scheme="http://hyzhangyong.github.io/tags/python/"/>
    
      <category term="threading" scheme="http://hyzhangyong.github.io/tags/threading/"/>
    
      <category term="线程池" scheme="http://hyzhangyong.github.io/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    
  </entry>
  
  <entry>
    <title>jQuery购物车特效</title>
    <link href="http://hyzhangyong.github.io/2016/03/11/%E9%A3%9E%E5%85%A5%E8%B4%AD%E7%89%A9%E8%BD%A6%E7%89%B9%E6%95%88/"/>
    <id>http://hyzhangyong.github.io/2016/03/11/飞入购物车特效/</id>
    <published>2016-03-11T14:16:42.000Z</published>
    <updated>2016-06-17T08:05:18.285Z</updated>
    
    <content type="html">&lt;p&gt;最近开发一个平台，需要购物车，仿照网上一些素材制作了一个飞入购物车的特效。&lt;br&gt;使用了以下脚本:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.jquery.min.js&lt;br&gt;2.jquery.fly.min.js&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;物品列表HTML代码:&lt;br&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;goodslist&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;url&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;inner&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;addcar&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;herf&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;javascript:void(0)&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;加入购物车&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;购物车代码:&lt;br&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;car&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;herf&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;#&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;end&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        购物车&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;调用函数:&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$(funciton()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; offset=$(&lt;span class=&quot;string&quot;&gt;&quot;#end&quot;&lt;/span&gt;).offset();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $(&lt;span class=&quot;string&quot;&gt;&quot;.addcar&quot;&lt;/span&gt;).click(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;event&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; addcar=$(&lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; img=addcar.parents().find(&lt;span class=&quot;string&quot;&gt;&#39;img&#39;&lt;/span&gt;).attr(&lt;span class=&quot;string&quot;&gt;&#39;src&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; flyer=$(&lt;span class=&quot;string&quot;&gt;&#39;&amp;lt;img class=&quot;u-flyer&quot; src=&quot;&#39;&lt;/span&gt;+img+&lt;span class=&quot;string&quot;&gt;&#39;&quot;&amp;gt;&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        flyer.fly(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	start:&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            	left:event.pageX,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                top:event.pageY&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            end:&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            left:offset.left,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            top:offset.top,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            width:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            height:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;飞入购物车图片样式&lt;br&gt;&lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;selector-class&quot;&gt;.u-flyer&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;display&lt;/span&gt;:block;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;width&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;50px&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;height&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;50px&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;border-radius&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;50px&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;position&lt;/span&gt;: fixed;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;z-index&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;9999&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;最近开发一个平台，需要购物车，仿照网上一些素材制作了一个飞入购物车的特效。&lt;br&gt;使用了以下脚本:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;1.jquery.min.js&lt;br&gt;2.jquery.fly.min.js&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;物品列表HTML代码:&lt;br&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;goodslist&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;src&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;url&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;inner&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;addcar&quot;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;herf&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;javascript:void(0)&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;加入购物车&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;购物车代码:&lt;br&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;car&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;herf&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;#&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    	&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;end&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        购物车&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="html" scheme="http://hyzhangyong.github.io/categories/html/"/>
    
    
      <category term="jQuery" scheme="http://hyzhangyong.github.io/tags/jQuery/"/>
    
      <category term="购物车" scheme="http://hyzhangyong.github.io/tags/%E8%B4%AD%E7%89%A9%E8%BD%A6/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu下安装Hexo与搭建Blog</title>
    <link href="http://hyzhangyong.github.io/2016/03/09/Ubuntu%E4%B8%8B%E5%AE%89%E8%A3%85Hexo%E4%B8%8E%E6%90%AD%E5%BB%BABlog/"/>
    <id>http://hyzhangyong.github.io/2016/03/09/Ubuntu下安装Hexo与搭建Blog/</id>
    <published>2016-03-09T06:39:27.000Z</published>
    <updated>2016-06-21T09:59:24.474Z</updated>
    
    <content type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言:&quot;&gt;&lt;/a&gt;前言:&lt;/h2&gt;&lt;p&gt;最近在github安了家，在很早之前就了解过可以利用Hexo+Github,建立静态博客。决定自己搭建一个。&lt;/p&gt;
&lt;h2 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; class=&quot;headerlink&quot; title=&quot;安装&quot;&gt;&lt;/a&gt;安装&lt;/h2&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;安装Node.js&lt;/li&gt;
&lt;li&gt;安装Git&lt;/li&gt;
&lt;li&gt;安装Hexo&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h4 id=&quot;1-安装-Node-js&quot;&gt;&lt;a href=&quot;#1-安装-Node-js&quot; class=&quot;headerlink&quot; title=&quot;1.安装 Node.js&quot;&gt;&lt;/a&gt;1.安装 Node.js&lt;/h4&gt;&lt;p&gt;安装Node.js的最佳方式是使用nvm.&lt;br&gt;curl:&lt;br&gt;&lt;code&gt;curl https://raw.github.com/creationix/nvm/master/install.sh | sh&lt;/code&gt;&lt;br&gt;wget&lt;br&gt;&lt;code&gt;wget -qO- https://raw.github.com/creationix/nvm/master/install.sh | sh&lt;/code&gt;&lt;br&gt;安装完后，重启终端并执行下列命令即可安装Node.js.&lt;br&gt;&lt;code&gt;nvm install 4&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;2-安装-Git&quot;&gt;&lt;a href=&quot;#2-安装-Git&quot; class=&quot;headerlink&quot; title=&quot;2.安装 Git&quot;&gt;&lt;/a&gt;2.安装 Git&lt;/h4&gt;&lt;p&gt;&lt;code&gt;sudo apt-get install git-core&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;3-安装-Hexo&quot;&gt;&lt;a href=&quot;#3-安装-Hexo&quot; class=&quot;headerlink&quot; title=&quot;3.安装 Hexo&quot;&gt;&lt;/a&gt;3.安装 Hexo&lt;/h4&gt;&lt;p&gt;所有必备得引用程序安装完成后，即可使用npm安装Hexo&lt;br&gt;&lt;code&gt;npm install -g hexo-cli&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;配置&quot;&gt;&lt;a href=&quot;#配置&quot; class=&quot;headerlink&quot; title=&quot;配置&quot;&gt;&lt;/a&gt;配置&lt;/h2&gt;&lt;h4 id=&quot;1-创建目录-Myblog&quot;&gt;&lt;a href=&quot;#1-创建目录-Myblog&quot; class=&quot;headerlink&quot; title=&quot;1.创建目录 Myblog&quot;&gt;&lt;/a&gt;1.创建目录 Myblog&lt;/h4&gt;&lt;p&gt;&lt;code&gt;mkdir Myblog&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;2-初始化-Hexo&quot;&gt;&lt;a href=&quot;#2-初始化-Hexo&quot; class=&quot;headerlink&quot; title=&quot;2.初始化 Hexo&quot;&gt;&lt;/a&gt;2.初始化 Hexo&lt;/h4&gt;&lt;p&gt;进入博客目录:&lt;code&gt;cd Myblog&lt;/code&gt;&lt;br&gt;执行&lt;code&gt;hexo init&lt;/code&gt;进行初始化，Hexo会自动在该文件夹下下载搭建网站所需得所有文件。&lt;br&gt;在Myblog目录下执行&lt;br&gt;&lt;code&gt;hexo g&lt;/code&gt;&lt;br&gt;&lt;code&gt;hexo s&lt;/code&gt;&lt;br&gt;然后在浏览器访问&lt;code&gt;http://localhost:4000&lt;/code&gt;,就应该可以访问博客了。&lt;/p&gt;
&lt;h2 id=&quot;建立Repository&quot;&gt;&lt;a href=&quot;#建立Repository&quot; class=&quot;headerlink&quot; title=&quot;建立Repository&quot;&gt;&lt;/a&gt;建立Repository&lt;/h2&gt;&lt;p&gt;建立与用户名对应的仓库，仓库名必须为【your_user_name.github.io】，固定写法，然后建立关联.&lt;br&gt;&lt;code&gt;cd Myblog&lt;/code&gt;&lt;br&gt;&lt;code&gt;vim _config.yml&lt;/code&gt;&lt;br&gt;翻到最下面，修改deploy&lt;br&gt;&lt;code&gt;type: git&lt;/code&gt;&lt;br&gt;&lt;code&gt;repository: https://github.com/hyzhangyong/hyzhangyong.github.io.git&lt;/code&gt;&lt;br&gt;&lt;code&gt;branch: master&lt;/code&gt;&lt;br&gt;&lt;code&gt;_config.yml参数后面必须有空格&lt;/code&gt;&lt;br&gt;然后执行配置命令:&lt;br&gt;&lt;code&gt;hexo deploy&lt;/code&gt;&lt;br&gt;然后在浏览器中输入&lt;code&gt;http://hyzhangyong.github.io&lt;/code&gt;即可访问博客&lt;/p&gt;
&lt;h2 id=&quot;编写新文章&quot;&gt;&lt;a href=&quot;#编写新文章&quot; class=&quot;headerlink&quot; title=&quot;编写新文章&quot;&gt;&lt;/a&gt;编写新文章&lt;/h2&gt;&lt;p&gt;执行&lt;br&gt;&lt;code&gt;cd Myblog&lt;/code&gt;&lt;br&gt;&lt;code&gt;hexo new &amp;quot;my new article&amp;quot;&lt;/code&gt;&lt;br&gt;就会自动在_posts目录下建立my new article.md文档，编辑该文档即可写作。&lt;/p&gt;
&lt;h2 id=&quot;上传博客&quot;&gt;&lt;a href=&quot;#上传博客&quot; class=&quot;headerlink&quot; title=&quot;上传博客&quot;&gt;&lt;/a&gt;上传博客&lt;/h2&gt;&lt;p&gt;每次在本地写好博客后，执行以下三步骤发布博客:&lt;br&gt;&lt;code&gt;hexo clean&lt;/code&gt;&lt;br&gt;&lt;code&gt;hexo generate&lt;/code&gt;&lt;br&gt;&lt;code&gt;hexo deploy&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;安装主题&quot;&gt;&lt;a href=&quot;#安装主题&quot; class=&quot;headerlink&quot; title=&quot;安装主题&quot;&gt;&lt;/a&gt;安装主题&lt;/h2&gt;&lt;p&gt;以我现在的主题为例&lt;/p&gt;
&lt;h4 id=&quot;1、进入博客目录，安装主题&quot;&gt;&lt;a href=&quot;#1、进入博客目录，安装主题&quot; class=&quot;headerlink&quot; title=&quot;1、进入博客目录，安装主题&quot;&gt;&lt;/a&gt;1、进入博客目录，安装主题&lt;/h4&gt;&lt;p&gt;&lt;code&gt;git clone https://github.com/MOxFIVE/hexo-theme-yelee.git themes/yelee&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;2、设置博客根目录下的-config-yml&quot;&gt;&lt;a href=&quot;#2、设置博客根目录下的-config-yml&quot; class=&quot;headerlink&quot; title=&quot;2、设置博客根目录下的_config.yml&quot;&gt;&lt;/a&gt;2、设置博客根目录下的_config.yml&lt;/h4&gt;&lt;p&gt;&lt;code&gt;theme: yelee&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;3、检查更新&quot;&gt;&lt;a href=&quot;#3、检查更新&quot; class=&quot;headerlink&quot; title=&quot;3、检查更新&quot;&gt;&lt;/a&gt;3、检查更新&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cd themes/yelee&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;git pull&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;4、详情配置见yelee目录下的README-md或者https-github-com-MOxFIVE-hexo-theme-yelee&quot;&gt;&lt;a href=&quot;#4、详情配置见yelee目录下的README-md或者https-github-com-MOxFIVE-hexo-theme-yelee&quot; class=&quot;headerlink&quot; title=&quot;4、详情配置见yelee目录下的README.md或者https://github.com/MOxFIVE/hexo-theme-yelee&quot;&gt;&lt;/a&gt;4、详情配置见&lt;code&gt;yelee&lt;/code&gt;目录下的README.md或者&lt;code&gt;https://github.com/MOxFIVE/hexo-theme-yelee&lt;/code&gt;&lt;/h4&gt;</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言:&quot;&gt;&lt;/a&gt;前言:&lt;/h2&gt;&lt;p&gt;最近在github安了家，在很早之前就了解过可以利用Hexo+Github,建立静态博客。决定自己搭建一个。&lt;/p&gt;
&lt;h2 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; class=&quot;headerlink&quot; title=&quot;安装&quot;&gt;&lt;/a&gt;安装&lt;/h2&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;安装Node.js&lt;/li&gt;
&lt;li&gt;安装Git&lt;/li&gt;
&lt;li&gt;安装Hexo&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Hexo" scheme="http://hyzhangyong.github.io/categories/Hexo/"/>
    
    
      <category term="Hexo" scheme="http://hyzhangyong.github.io/tags/Hexo/"/>
    
  </entry>
  
</feed>
